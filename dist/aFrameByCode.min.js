(function(l){AFRAME.$=$=document.querySelector.bind(document);AFRAME.$$=$$=document.querySelectorAll.bind(document);var f=function(p,g,r){var q=0;return function(){r&&r(Math.min(p,q+1),p);if(++q>=p){p=null;if(r){r=null}if(g){g();g=null}}}};var o=function(){var u;if(typeof arguments[0]=="string"){u={tag:arguments[0]};if(typeof arguments[1]=="string"){u.attributes=arguments[2]||{};u.attributes.src=arguments[1]}else{if(arguments[1].attributes){u.attributes=arguments[1].attributes;u.children=arguments[1].children}else{if(arguments[1].children){u.attributes={};u.children=arguments[1].children}else{u.attributes=arguments[1]||{}}}}}else{u=arguments[0]}var p={attributes:{}};if(true){var g=u.tag||"a-entity";var v="";var r=g.split("#");if(r.length>1){g=r[0];v=r[1]}p.tag=g;p.attributes.id=v}for(var t in u.attributes){p.attributes[t]=u.attributes[t]}if(u.children){var s=u.children;p.children=[];if(Array.isArray(s)){for(var q=0;q<s.length;q++){p.children.push(o(s[q]))}}else{for(var q in s){p.children.push(o(q,s[q]))}}}return p};var h=function(p){var s=document.createElement("div");s.innerHTML=(p||"").replace(/\n/g,"").replace(/\s+/g," ").replace(/^\s*/,"").replace(/\s*$/,"").replace(/>\s*</g,"><");var q=function(y,z){var u={tag:y.localName};z.push(u);if(y.attributes.length>0){var t=u.attributes={};for(var v=0;v<y.attributes.length;v++){t[y.attributes[v].name]=y.attributes[v].value}}if(y.children.length>0){var x=u.children=[];for(var w=0;w<y.children.length;w++){q(y.children[w],x)}}};var r=[];try{q(s,r)}catch(g){console.log("err html",g)}return(r[0]&&r[0].children)||[]};var k=function(){var g=o.apply(o,arguments);return this.createAnEntity(g,this)};var d=function(s,p){if(!s){return}var r;if(Array.isArray(s)){for(var q=0;q<s.length;q++){r=this.createAnEntity(s[q],this);p&&p(r)}}else{if(typeof s=="string"){var t=h(s);d.bind(this)(t,p)}else{for(var g in s){r=this.addAnEntity(g,s[g]);p&&p(r)}}}};var m=function(r,q){if(typeof q=="undefined"){q=this}var r=o(r);var p=document.createElement(r.tag);if(q){q.appendChild(p)}i(p);c(p,r.attributes);if(r.children){for(var g=0;g<r.children.length;g++){this.createAnEntity(r.children[g],p)}}return p};var b=function(p){var g=AFRAME.$(p);g.parentNode.removeChild(g)};var n=function(q){var p=$$(q);for(var g=0;g<p.length;g++){p[g].parentNode&&p[g].parentNode.removeChild(p[g])}};var a=function(){this.onRemove&&this.onRemove();delete this.onRemove;this.parentNode&&this.parentNode.removeChild(this)};var c=function(q,g){if(typeof g=="function"){g=g()}if(g){for(var p in g){q.setAttribute(p,g[p]||"")}}};var i=function(g){g.addAnEntity=k.bind(g);g.addEntities=d.bind(g);g.createAnEntity=m.bind(g);g.removeAnEntity=b.bind(g);g.removeEntities=n.bind(g);g.removeMe=a.bind(g);g.setAttributes=function(p){c(g,p)};return g};AFRAME.extScenes={};AFRAME.extCurrScene=null;AFRAME.createAScene=function(g){AFRAME.extScenes[g.id]=g;return this};AFRAME.loadScene=function(g){if(this.extCurrScene){this.extCurrScene.removeMe()}var q=document.createElement("a-scene");i(q);var s=this.extScenes[g];if(!s){return console.error("No scene: "+g)}document.body.appendChild(q);if(s.onRemove){q.onRemove=s.onRemove.bind(s)}this.extCurrScene=q;var p=s.attributes||{};if(typeof p=="function"){p=p()}p.id=g;c(q,p);q.addAnEntity("a-assets",{id:"assets"});q.assets=new j("#assets");var r=s.assets||{};if(typeof r=="function"){r=r()}q.assets.addList(r);q.addEntities(s.children);if(s.onInit){s.onInit.bind(s)(q)}q.assets.load(function(){var t=function(){s.onLoaded&&s.onLoaded.bind(s)(q)}.bind(this);if(q.hasLoaded){t()}else{q.addEventListener("loaded",t)}},s.onLoading&&s.onLoading.bind(s))};var e=function(p,g,r){if(!r){return}var q=function(){p.removeEventListener(p._eventName,q);delete p._eventName;var s=r;r=null;s()};if(g=="script"){return p.onload=function(){delete p.onload;var s=r;r=null;s()}}if(g=="img"){p._eventName="load"}else{if(g=="audio"||g=="video"){p._eventName="loadeddata"}else{p._eventName="loaded"}}p.addEventListener(p._eventName,q)};var j=function(g){this.id=g;this.list={}};j.prototype.add=function(){var r=o.apply(o,arguments);if(!r.attributes.crossorigin){r.attributes.crossorigin="anonymous"}var g=r.tag;var p=$(this.id);var q=p.addAnEntity(r);this.list[g]=q;return this};j.prototype.addList=function(q){if(!q){return}if(Array.isArray(q)){for(var p=0;p<q.length;p++){this.add(q[p])}}else{for(var g in q){this.add(g,q[g])}}return this};j.prototype.load=function(p,u){var t=this.list;this.list={};var q=0;for(var s in t){q++}if(q<1){return p&&p()}var r=f(q,function(){p&&p()},u);for(var g in t){e(t[g],g,r)}return this};AFRAME.registerComponent("f-click-to-scene",{schema:{scene:{type:"string"}},init:function(){this.el.addEventListener("click",this.loadScene.bind(this))},loadScene:function(){AFRAME.loadScene(this.data.scene)},remove:function(){this.el.removeEventListener("click",this.loadScene.bind(this))}});document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);var g=document.body.getAttribute("scene");if(g){AFRAME.loadScene(g)}},false)})(window);